# Modern C++ Project Template

This repository serves as a robust foundation for C++ projects, configured for the modern **C++23** standard. It features a pre-configured CMake build system, integration with code sanitizers, static analysis, code formatting, and unit testing.

## Features at a Glance

* **Standard:** C++23 required.
* **Build System:** Uses `CMakePresets.json` for streamlined, repeatable configuration across different environments.
* **Code Safety:** Seamless integration with Clang/GCC Sanitizers (Address, Thread, Memory, Undefined).
* **Code Quality:**
    * Strict compiler warnings (`-Wall -Wextra -Wpedantic`, etc.) enforced via `CompilerWarnings.cmake`.
    * Automatic formatting check (`clang-format`).
    * Static analysis (`clang-tidy`).
* **Testing:** Integrated unit testing using Google Test (GTest).

## Prerequisites

To fully utilize this project, you will need the following tools installed:

* **CMake** (version 3.25 or higher)
* **C++ Compiler** with C++23 support (GCC, Clang, or MSVC)
* **Ninja** (Recommended generator, specified in the presets)
* **Python 3** (Required for the static analysis scripts)
* **GTest** (The build script attempts to find it via `find_package(GTest)`)
* **LLVM Utilities** (`clang-format`, `clang-tidy`, `gcov/lcov`(optional))

## Building and Running

The project heavily relies on **CMake Presets** defined in `CMakePresets.json`. This simplifies the build process by eliminating the need for long, error-prone command-line arguments.

### 1. View Available Presets

To see all available configurations:

```bash
cmake --list-presets
````

### 2\. Configuration and Building (Development)

The most common scenario is a Debug build with the **Address Sanitizer (ASan)** enabled to catch memory leaks and access violations.

**Configure:**

```bash
cmake --preset dev-debug-asan
```

**Build:**

```bash
cmake --build --preset dev-debug-asan
```

*Alternatively (Standard CMake):*

```bash
cmake --build build/dev-debug-asan
```

### 3\. Using Other Sanitizer Profiles

The template includes specialized profiles for debugging various issues:

| Preset Name | Sanitizer | Purpose |
| :--- | :--- | :--- |
| `dev-debug-asan` | Address | Memory errors, leaks, use-after-free. |
| `dev-debug-tsan` | Thread | Data races and deadlocks in concurrent code. |
| `dev-debug-msan` | Memory | Checks for uninitialized reads (Requires special libc++ build). |
| `dev-debug-ubsan` | Undefined | Undefined Behavior (e.g., integer overflows, unaligned loads). |
*ubsan is included in all other sanitizer modes.*

Example to build with Thread Sanitizer (TSan):
```bash
cmake --preset dev-debug-tsan
cmake --build --preset dev-debug-tsan
```

### 4\. Release Build (CI / Production)

For maximum performance (no sanitizers, optimized compilation):

```bash
cmake --preset ci-release
cmake --build --preset ci-release
```

## Testing and Quality Checks

Tests are managed using CTest. Test presets are defined to match the configuration presets.

### Unit Tests (GTest)

Run the unit tests compiled under the `dev-debug-asan` configuration:

```bash
ctest --preset dev-debug-asan
```

### Static Analysis and Formatting

The `clang-format` and `clang-tidy` checks are implemented as **CTest tests**. This allows them to run alongside unit tests or individually.

**Run Format Check only:**

```bash
ctest --preset dev-debug-asan -R FormatCheck
```

**Run Tidy Check only (Static Analysis):**

```bash
ctest --preset dev-debug-asan -R TidyCheck
```

*Note: The Tidy Check requires the `compile_commands.json` file, which is automatically generated by the presets.*

## Project Structure Explained

| Directory | Purpose |
| :--- | :--- |
| `app/` | Contains the `main.cpp` and configuration for the primary executable. |
| `src/` | Source files for the core library. Should be compiled into a library target. |
| `include/` | Public header files, often installed or included by other components. |
| `tests/unit/` | Google Test suites and source files. |
| `tests/static/` | Configuration for static analysis targets. |
| `tests/scripts/` | Python/Bash scripts that execute `clang-format` and `clang-tidy`. |
| `cmake/` | Custom CMake modules (`CompilerWarnings.cmake`, `Sanitizers.cmake`, etc.). |
| `CMakePresets.json` | Defines all configuration and build presets. |

## Customization

To adapt this template to your own project:

1.  Open the root `CMakeLists.txt`.
2.  Change the project name in the first line:
    ```cmake
    project(MyCoolNewApp LANGUAGES CXX)
    ```
3.  Add your application logic in `src/` and include public interfaces in `include/`.
4.  Add new test suites to `tests/unit/` and register them in `tests/unit/CMakeLists.txt` using the provided `add_gtest` function:
    ```cmake
    add_gtest(MyModuleTest SOURCES my_module_test.cpp LIBRARIES project_lib)
    ```

## Contribution Guidelines

Before submitting any code changes, ensure all quality checks and tests pass using a clean release configuration:

```bash
# 1. Configure and Build
cmake --preset ci-release
cmake --build --preset ci-release

# 2. Run All Tests (Unit + Static Analysis)
ctest --preset ci-release

cmake --build --preset dev-debug-asan --target clean
cmake --build --preset ci-release --target clean

cmake --preset dev-debug-asan --fresh

cmake --build --preset dev-debug-asan --target format
ctest --preset dev-debug-asan --include TidyCheck
```

# TODO
fix CXX_COMPILER_ID:MSVC
>>>>>>> 1d6d514dbfd41d311e19a7df4db3d5a536f1b893
